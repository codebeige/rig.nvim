#! /usr/bin/env zsh

root_dir=${0:a:h:h}

# nvim -l always writes to stderr
# see https://github.com/neovim/neovim/issues/27084
output=$($root_dir/bin/fennel \
  --compile $@ 2>&1)

if [[ $output =~ ^[^[:space:]]+:[[:space:]] ]]; then
  >&2 echo $output
  exit 1
else
  echo $output
fi
